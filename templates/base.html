<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loan Default System</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}" />
  {% block extra_head %}{% endblock %}
</head>

<body>
  <div class="mobile-header">
    <div class="logo"
      style="font-size: 1.25rem; font-weight: 800; color: var(--text-main); display: flex; align-items: center; gap: 0.5rem;">
      <i class="fas fa-layer-group"></i> LoanDefault
    </div>
    <div class="mobile-toggle" id="mobile-toggle">
      <i class="fas fa-bars"></i>
    </div>
  </div>

  {% include 'toast.html' %}
  {% block content %}{% endblock %}
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const themeToggle = document.getElementById("theme-toggle");
      const themeIcon = document.getElementById("theme-icon");
      const themeText = document.getElementById("theme-text");
      const mobileToggle = document.getElementById("mobile-toggle");
      const sidebar = document.querySelector(".sidebar");
      const sidebarClose = document.getElementById("sidebar-close");

      if (mobileToggle && sidebar) {
        mobileToggle.addEventListener("click", () => {
          sidebar.classList.toggle("active");
        });
      }

      if (sidebarClose && sidebar) {
        sidebarClose.addEventListener("click", () => {
          sidebar.classList.remove("active");
        });
      }

      // Close sidebar when clicking outside on mobile
      document.addEventListener("click", (e) => {
        if (sidebar && sidebar.classList.contains("active") && !sidebar.contains(e.target) && !mobileToggle.contains(e.target)) {
          sidebar.classList.remove("active");
        }
      });

      // Check current theme
      if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("dark-theme");
        if (themeIcon) {
          themeIcon.classList.remove("fa-moon", "far");
          themeIcon.classList.add("fa-sun", "fas");
          themeText.textContent = "Light Mode";
        }
      }

      if (themeToggle) {
        themeToggle.addEventListener("click", () => {
          document.body.classList.toggle("dark-theme");
          const isDark = document.body.classList.contains("dark-theme");
          localStorage.setItem("theme", isDark ? "dark" : "light");

          if (isDark) {
            themeIcon.classList.remove("fa-moon", "far");
            themeIcon.classList.add("fa-sun", "fas");
            themeText.textContent = "Light Mode";
          } else {
            themeIcon.classList.remove("fa-sun", "fas");
            themeIcon.classList.add("fa-moon", "far");
            themeText.textContent = "Dark Mode";
          }

          // Dispatch custom event for charts to listen to
          window.dispatchEvent(new Event('themeChanged'));
        });
      }
    });
  </script>
</body>

</html>